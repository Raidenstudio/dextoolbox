export default async function handler(req,res){ if(req.method!=='POST') return res.status(405).json({error:'Method not allowed'}); const body = req.body || {}; const FORM_ENDPOINT = process.env.FORM_ENDPOINT || ''; if(FORM_ENDPOINT){ try{ await fetch(FORM_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body: JSON.stringify(body)}); return res.status(200).json({ok:true,forwarded:true}); }catch(err){ console.error(err); return res.status(500).json({ok:false,error:'forward failed'}); } } const SMTP_HOST = process.env.SMTP_HOST; if(SMTP_HOST){ return res.status(200).json({ok:true,note:'SMTP configured - implement nodemailer in production'}); } const fs = require('fs'), path = require('path'); const file = path.join(process.cwd(),'enquiries.json'); const list = fs.existsSync(file) ? JSON.parse(fs.readFileSync(file)) : []; list.unshift({...body, time: new Date().toISOString()}); fs.writeFileSync(file, JSON.stringify(list, null, 2)); return res.status(200).json({ok:true,saved:true}); }
